"use strict";(function(){var geadenControllers=angular.module("geadenControllers",["geadenServices","toaster","angularMoment"]);geadenControllers.controller("MyCtrl",["$scope","Me","moment","$log",function($scope,Me,moment,$log){$scope.info=Me.query();$scope.age=function(){var bday=new Date($scope.info.birthDay);var age=moment().diff(moment(bday));return 27;};$(window).scroll(function(){if($(this).scrollTop()>=100){$("#up").fadeIn(400);}else{$("#up").fadeOut(400);}});$("#up").click(function(){$("body,html").animate({scrollTop:0},500);});Pace.once("done",function(){$(".content").fadeIn(1000);$(".content").removeClass("loading");});}]);geadenControllers.controller("QuotesCtrl",["$scope","Quote","$timeout","$log",function($scope,Quote,$timeout,$log){$scope.currentQuoteIndex=0;$scope.quotes=Quote.query();$scope.nextQuote=function(){$scope.selectQuote(++$scope.currentQuoteIndex%$scope.quotes.length);};$scope.selectQuote=function(index){$scope.currentQuoteIndex=index;};$scope.isCurrent=function(index){return $scope.currentQuoteIndex===index;};$scope.prevQuote=function(){var up=$scope.currentQuoteIndex>0;if(!up){$scope.currentQuoteIndex=$scope.quotes.length;}$scope.selectQuote(--$scope.currentQuoteIndex);};$scope.addQuote=function(author,content){$scope.quotes.push({author:author,quote:content});};var looptTimeout=8000;var quotesLoop=function(){$scope.nextQuote();$timeout(quotesLoop,looptTimeout);};$timeout(quotesLoop,looptTimeout);}]);geadenControllers.controller("SkillsCtrl",["$scope","Skills","Link","$http","toaster","$timeout","$log",function($scope,Skills,Link,$http,toaster,$timeout,$log){$scope.shownIdx=undefined;$scope.skills=Skills.query();$scope.skill={links:[]};$scope.link={};$scope.showDescription=function(skillsIdx){if($scope.isShown(skillsIdx)){$scope.shownIdx=undefined;}else{$scope.shownIdx=skillsIdx;}};$scope.resetSkill=function(){$scope.skill={links:[]};};$scope.addSkill=function(skill){if(!skill._id){$http.post("/skills/",{data:skill,action:"new"}).success(function(data){$scope.skills.push(data);toaster.pop("success","Skill added","Skill with id "+data._id+" added.");});}else{$http.post("/skills/",{data:skill,action:"update"}).success(function(data){skill=data;toaster.pop("success","Skill updated","Skill with id "+data._id+" updated.");});}$scope.skill={links:[]};};$scope.toggleAvailableLinks=function(link){link.showAvailableLinks=!link.showAvailableLinks;if(!link.showAvailableLinks){delete link.showAvailableLinks;}};$scope.editSkill=function(skill){$scope.availableLinks=Link.query();$scope.skill=skill;$(".skill-form input")[0].focus();};$scope.removeSkill=function(skill,idx){$http.post("/skills/",{_id:skill._id,action:"delete"}).success(function(){toaster.pop("info","Skill removed!","Skill "+skill.title+" was removed.");}).error(function(){toaster.pop("error","Error","Error removing skill "+skill.title);});$scope.skill={links:[]};$scope.skills.splice(idx,1);};$scope.selectSkillLink=function(link,idx){$scope.skill.links[idx]=link;};$scope.newSkillLink=function(skill){$scope.availableLinks=Link.query();skill.links.push($scope.link);$scope.link={};$(".link-url").on;};$scope.removeSkillLink=function(skill,link,idx){skill.links.splice(idx,1);};$scope.q=null;var availableLinks=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("title"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,remote:"/links",prefetch:{url:"/links"}});availableLinks.initialize();$scope.queryLink=function(link,q){availableLinks.get(q,function(suggestions){$log.info(suggestions);$scope.availableLinks=suggestions;link.showAvailableLinks=true;});if(!q){link.showAvailableLinks=false;delete link.showAvailableLinks;}};$scope.approve=function(skill){$http.post("/skills/approve/",{_id:skill._id}).success(function(){toaster.pop("success","Skill Approved!","Thanks for approving "+skill.title);});skill.approved+=1;};$scope.isShown=function(skillsIdx){return $scope.shownIdx===skillsIdx;};}]);geadenControllers.controller("LinksCtrl",["$scope","Link","$http","toaster","$log",function($scope,Link,$http,toaster,$log){$scope.link={};$scope.links=Link.query();$scope.newLink=function(link){var index=$scope.links.map(function(l){return l.url;}).indexOf(link.url);var action="updated";if(index==-1){action="added";}$http.post("/links",link).success(function(data){if(action=="added"){$scope.links.push(link);}toaster.pop("success","Link "+action,"Link "+link.url+" "+action);}).error(function(error){toaster.pop("error","Error: "+error);});$scope.link={};};$scope.editLink=function(link){$scope.link=link;$(".link-form input")[0].focus();};$scope.removeLink=function(link,idx){$scope.links.splice(idx,1);toaster.pop("info","Link removed","Link "+link.url+" removed.");};$scope.resetLink=function(){$scope.link={};};}]);geadenControllers.controller("TabsCtrl",["$scope","$log",function($scope,$log){$scope.tabIndex=0;$scope.tabs=["Skills","Links"];$scope.selectTab=function(idx){$scope.tabIndex=idx;};$scope.currentTab=function(idx){return $scope.tabIndex===idx;};}]);geadenControllers.controller("EducationCtrl",["$scope","Education","$log",function($scope,Education,$log){$scope.educationList=Education.query();}]);geadenControllers.controller("ExperienceCtrl",["$scope","Experience","$log",function($scope,Experience,$log){$scope.experienceList=Experience.query();}]);geadenControllers.controller("ContactsCtrl",["$scope","Contact","$http","toaster","$log",function($scope,Contact,$http,toaster,$log){$scope.contacts=Contact.query();$scope.email="";$scope.subject="";$scope.message="";$scope.sendMessage=function(){$log.info("sending...");$http.post("/email",{subject:$scope.subject,email:$scope.email,message:$scope.message}).success(function(data){toaster.pop("success","Thanks","Thanks for your message ;)");$scope.resetEmail();}).error(function(error){toaster.pop("error","Error","Sorry, couldn't handle that :(");});};$scope.resetEmail=function(){$scope.email="";$scope.subject="";$scope.message="";};}]);})();